<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="teamproject.usedmarket.repository.mybatis.LikeMapper">

    <insert id="addInterest" useGeneratedKeys="true" keyProperty="itemLikeId">
        INSERT INTO item_like (member_id, item_id)
        VALUES (#{memberId}, #{itemId})
    </insert>

    <delete id="removeInterest">
        DELETE FROM item_like WHERE member_id = #{memberId} AND item_id = #{itemId}
    </delete>

    <!-- 해당 회원이 특정 상품에 대한 관심 여부를 확인하는 쿼리 -->
    <select id="existsByMemberIdAndItemId" resultType="boolean" parameterType="map">
        SELECT COUNT(*) > 0
        FROM item_like
        WHERE member_id = #{memberId}
        AND item_id = #{itemId}
    </select>

    <select id="findLikedItemByMemberId" resultType="item">
        SELECT i.*
        FROM item_like il
        JOIN item i ON il.item_id = i.item_id
        WHERE il.member_id = #{memberId}
    </select>

    <select id="totalLikedItem" resultType="java.lang.Integer">
        SELECT COUNT(*) AS totalLikedItem
        FROM item_like
        WHERE item_id = #{itemId}
    </select>

<!--    &lt;!&ndash; 페이징을 고려한 아이템 목록 조회 &ndash;&gt;-->
<!--    <select id="findLikedItemsWithPaging" parameterType="map" resultType="item">-->
<!--        SELECT i.*-->
<!--        FROM item_like il-->
<!--        JOIN item i ON il.item_id = i.item_id-->
<!--        WHERE il.member_id = #{memberId}-->
<!--        ORDER BY create_datetime DESC LIMIT #{params.startRow}, #{params.pageSize}-->
<!--    </select>-->

<!--    &lt;!&ndash; 전체 아이템 수 조회 &ndash;&gt;-->
<!--    <select id="countItems" resultType="int">-->
<!--        SELECT COUNT(*) FROM item_like-->
<!--        WHERE member_id = #{memberId}-->
<!--    </select>-->


</mapper>